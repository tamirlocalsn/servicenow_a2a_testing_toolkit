<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="ServiceNow A2A Testing Tools" />
  <title>ServiceNow A2A Testing - ServiceNow_A2A_Testing_Guide</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">ServiceNow A2A Testing -
ServiceNow_A2A_Testing_Guide</h1>
<p class="author">ServiceNow A2A Testing Tools</p>
<p class="date">September 2025</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#servicenow-agent-to-agent-a2a-testing-guide"
id="toc-servicenow-agent-to-agent-a2a-testing-guide"><span
class="toc-section-number">1</span> ServiceNow Agent-to-Agent (A2A)
Testing Guide</a>
<ul>
<li><a href="#table-of-contents" id="toc-table-of-contents"><span
class="toc-section-number">1.1</span> Table of Contents</a></li>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">1.2</span> Overview</a>
<ul>
<li><a href="#whats-included" id="toc-whats-included"><span
class="toc-section-number">1.2.1</span> What’s Included</a></li>
<li><a href="#key-features" id="toc-key-features"><span
class="toc-section-number">1.2.2</span> Key Features</a></li>
</ul></li>
<li><a href="#prerequisites" id="toc-prerequisites"><span
class="toc-section-number">1.3</span> Prerequisites</a>
<ul>
<li><a href="#system-requirements" id="toc-system-requirements"><span
class="toc-section-number">1.3.1</span> System Requirements</a></li>
<li><a href="#servicenow-requirements"
id="toc-servicenow-requirements"><span
class="toc-section-number">1.3.2</span> ServiceNow Requirements</a></li>
<li><a href="#python-dependencies" id="toc-python-dependencies"><span
class="toc-section-number">1.3.3</span> Python Dependencies</a></li>
</ul></li>
<li><a href="#quick-start" id="toc-quick-start"><span
class="toc-section-number">1.4</span> Quick Start</a>
<ul>
<li><a href="#download-and-setup" id="toc-download-and-setup"><span
class="toc-section-number">1.4.1</span> 1. Download and Setup</a></li>
<li><a href="#configure-your-environment"
id="toc-configure-your-environment"><span
class="toc-section-number">1.4.2</span> 2. Configure Your
Environment</a></li>
<li><a href="#run-your-first-test" id="toc-run-your-first-test"><span
class="toc-section-number">1.4.3</span> 3. Run Your First Test</a></li>
</ul></li>
<li><a href="#testing-tools" id="toc-testing-tools"><span
class="toc-section-number">1.5</span> Testing Tools</a>
<ul>
<li><a href="#automated-testing-script-test_servicenow_agent.sh"
id="toc-automated-testing-script-test_servicenow_agent.sh"><span
class="toc-section-number">1.5.1</span> 1. Automated Testing Script
(<code>test_servicenow_agent.sh</code>)</a></li>
<li><a href="#python-generic-client-generic_a2a_client.py"
id="toc-python-generic-client-generic_a2a_client.py"><span
class="toc-section-number">1.5.2</span> 2. Python Generic Client
(<code>generic_a2a_client.py</code>)</a></li>
<li><a href="#curl-command-generator-generate_curl_commands.sh"
id="toc-curl-command-generator-generate_curl_commands.sh"><span
class="toc-section-number">1.5.3</span> 3. Curl Command Generator
(<code>generate_curl_commands.sh</code>)</a></li>
</ul></li>
<li><a href="#configuration-guide" id="toc-configuration-guide"><span
class="toc-section-number">1.6</span> Configuration Guide</a>
<ul>
<li><a href="#environment-variables"
id="toc-environment-variables"><span
class="toc-section-number">1.6.1</span> Environment Variables</a></li>
<li><a href="#finding-your-agent-id"
id="toc-finding-your-agent-id"><span
class="toc-section-number">1.6.2</span> Finding Your Agent ID</a></li>
<li><a href="#generating-an-api-key"
id="toc-generating-an-api-key"><span
class="toc-section-number">1.6.3</span> Generating an API Key</a></li>
</ul></li>
<li><a href="#testing-methods" id="toc-testing-methods"><span
class="toc-section-number">1.7</span> Testing Methods</a>
<ul>
<li><a href="#method-1-automated-testing-script"
id="toc-method-1-automated-testing-script"><span
class="toc-section-number">1.7.1</span> Method 1: Automated Testing
Script</a></li>
<li><a href="#method-2-python-client"
id="toc-method-2-python-client"><span
class="toc-section-number">1.7.2</span> Method 2: Python Client</a></li>
<li><a href="#method-3-manual-curl-commands"
id="toc-method-3-manual-curl-commands"><span
class="toc-section-number">1.7.3</span> Method 3: Manual Curl
Commands</a></li>
</ul></li>
<li><a href="#python-client-implementation"
id="toc-python-client-implementation"><span
class="toc-section-number">1.8</span> Python Client Implementation</a>
<ul>
<li><a href="#complete-generic-client-code"
id="toc-complete-generic-client-code"><span
class="toc-section-number">1.8.1</span> Complete Generic Client
Code</a></li>
</ul></li>
<li><a href="#curl-testing-scripts" id="toc-curl-testing-scripts"><span
class="toc-section-number">1.9</span> Curl Testing Scripts</a>
<ul>
<li><a href="#automated-testing-script"
id="toc-automated-testing-script"><span
class="toc-section-number">1.9.1</span> Automated Testing
Script</a></li>
</ul></li>
<li><a href="#troubleshooting" id="toc-troubleshooting"><span
class="toc-section-number">1.10</span> Troubleshooting</a>
<ul>
<li><a href="#common-issues-and-solutions"
id="toc-common-issues-and-solutions"><span
class="toc-section-number">1.10.1</span> Common Issues and
Solutions</a></li>
<li><a href="#debugging-tips" id="toc-debugging-tips"><span
class="toc-section-number">1.10.2</span> Debugging Tips</a></li>
</ul></li>
<li><a href="#appendix" id="toc-appendix"><span
class="toc-section-number">1.11</span> Appendix</a>
<ul>
<li><a href="#a.-servicenow-a2a-protocol-details"
id="toc-a.-servicenow-a2a-protocol-details"><span
class="toc-section-number">1.11.1</span> A. ServiceNow A2A Protocol
Details</a></li>
<li><a href="#b.-file-structure" id="toc-b.-file-structure"><span
class="toc-section-number">1.11.2</span> B. File Structure</a></li>
<li><a href="#c.-environment-template"
id="toc-c.-environment-template"><span
class="toc-section-number">1.11.3</span> C. Environment
Template</a></li>
<li><a href="#d.-requirements-file" id="toc-d.-requirements-file"><span
class="toc-section-number">1.11.4</span> D. Requirements File</a></li>
</ul></li>
<li><a href="#support-and-resources"
id="toc-support-and-resources"><span
class="toc-section-number">1.12</span> Support and Resources</a>
<ul>
<li><a href="#servicenow-documentation"
id="toc-servicenow-documentation"><span
class="toc-section-number">1.12.1</span> ServiceNow
Documentation</a></li>
<li><a href="#community-resources" id="toc-community-resources"><span
class="toc-section-number">1.12.2</span> Community Resources</a></li>
<li><a href="#contact-information" id="toc-contact-information"><span
class="toc-section-number">1.12.3</span> Contact Information</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1"
id="servicenow-agent-to-agent-a2a-testing-guide"><span
class="header-section-number">1</span> ServiceNow Agent-to-Agent (A2A)
Testing Guide</h1>
<p><strong>Version:</strong> 1.0<br />
<strong>Date:</strong> September 2025<br />
<strong>Audience:</strong> ServiceNow Customers, Developers, and System
Administrators</p>
<hr />
<h2 data-number="1.1" id="table-of-contents"><span
class="header-section-number">1.1</span> Table of Contents</h2>
<ol type="1">
<li><a href="#overview">Overview</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#testing-tools">Testing Tools</a></li>
<li><a href="#configuration-guide">Configuration Guide</a></li>
<li><a href="#testing-methods">Testing Methods</a></li>
<li><a href="#python-client-implementation">Python Client
Implementation</a></li>
<li><a href="#curl-testing-scripts">Curl Testing Scripts</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#appendix">Appendix</a></li>
</ol>
<hr />
<h2 data-number="1.2" id="overview"><span
class="header-section-number">1.2</span> Overview</h2>
<p>This guide provides comprehensive tools and instructions for testing
ServiceNow Agent-to-Agent (A2A) implementations. It includes both
Python-based clients and curl-based testing scripts that work with any
ServiceNow instance and agent.</p>
<h3 data-number="1.2.1" id="whats-included"><span
class="header-section-number">1.2.1</span> What’s Included</h3>
<ul>
<li><strong>Generic Python A2A Client</strong> - Production-ready client
for any ServiceNow instance</li>
<li><strong>Automated Testing Scripts</strong> - Bash scripts for quick
testing with curl</li>
<li><strong>Configuration Templates</strong> - Easy setup for different
environments</li>
<li><strong>Troubleshooting Guide</strong> - Common issues and
solutions</li>
</ul>
<h3 data-number="1.2.2" id="key-features"><span
class="header-section-number">1.2.2</span> Key Features</h3>
<p>✅ <strong>Universal Compatibility</strong> - Works with any
ServiceNow instance and agent<br />
✅ <strong>Multiple Testing Methods</strong> - Python SDK, direct HTTP,
and curl<br />
✅ <strong>Comprehensive Error Handling</strong> - Detailed error
messages and debugging<br />
✅ <strong>Production Ready</strong> - Suitable for development,
testing, and production use</p>
<hr />
<h2 data-number="1.3" id="prerequisites"><span
class="header-section-number">1.3</span> Prerequisites</h2>
<h3 data-number="1.3.1" id="system-requirements"><span
class="header-section-number">1.3.1</span> System Requirements</h3>
<ul>
<li><strong>Operating System:</strong> macOS, Linux, or Windows with
WSL</li>
<li><strong>Python:</strong> 3.8 or higher (for Python clients)</li>
<li><strong>curl:</strong> Available on most systems</li>
<li><strong>jq:</strong> Optional, for pretty JSON formatting</li>
</ul>
<h3 data-number="1.3.2" id="servicenow-requirements"><span
class="header-section-number">1.3.2</span> ServiceNow Requirements</h3>
<ul>
<li><strong>ServiceNow Instance</strong> with A2A capabilities</li>
<li><strong>Agent ID</strong> of the agent you want to test</li>
<li><strong>API Key</strong> with appropriate permissions for A2A
operations</li>
</ul>
<h3 data-number="1.3.3" id="python-dependencies"><span
class="header-section-number">1.3.3</span> Python Dependencies</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install httpx a2a-sdk</span></code></pre></div>
<hr />
<h2 data-number="1.4" id="quick-start"><span
class="header-section-number">1.4</span> Quick Start</h2>
<h3 data-number="1.4.1" id="download-and-setup"><span
class="header-section-number">1.4.1</span> 1. Download and Setup</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create project directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> servicenow-a2a-testing</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> servicenow-a2a-testing</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy all provided files to this directory</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (generic_a2a_client.py, test_servicenow_agent.sh, etc.)</span></span></code></pre></div>
<h3 data-number="1.4.2" id="configure-your-environment"><span
class="header-section-number">1.4.2</span> 2. Configure Your
Environment</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the template</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> .env.template .env</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit .env with your ServiceNow details</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_INSTANCE</span><span class="op">=</span>your-instance.service-now.com</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_AGENT_ID</span><span class="op">=</span>your-agent-id</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_TOKEN</span><span class="op">=</span>your-api-key</span></code></pre></div>
<h3 data-number="1.4.3" id="run-your-first-test"><span
class="header-section-number">1.4.3</span> 3. Run Your First Test</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test with the automated script</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or test with Python</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> generic_a2a_client.py</span></code></pre></div>
<hr />
<h2 data-number="1.5" id="testing-tools"><span
class="header-section-number">1.5</span> Testing Tools</h2>
<p>This guide provides three main testing approaches:</p>
<h3 data-number="1.5.1"
id="automated-testing-script-test_servicenow_agent.sh"><span
class="header-section-number">1.5.1</span> 1. Automated Testing Script
(<code>test_servicenow_agent.sh</code>)</h3>
<ul>
<li><strong>Best for:</strong> Quick validation and debugging</li>
<li><strong>Features:</strong> Full workflow testing, error handling,
response parsing</li>
<li><strong>Usage:</strong>
<code>./test_servicenow_agent.sh [options]</code></li>
</ul>
<h3 data-number="1.5.2"
id="python-generic-client-generic_a2a_client.py"><span
class="header-section-number">1.5.2</span> 2. Python Generic Client
(<code>generic_a2a_client.py</code>)</h3>
<ul>
<li><strong>Best for:</strong> Integration into applications</li>
<li><strong>Features:</strong> Production-ready, configurable,
conversation context</li>
<li><strong>Usage:</strong> Import as module or run directly</li>
</ul>
<h3 data-number="1.5.3"
id="curl-command-generator-generate_curl_commands.sh"><span
class="header-section-number">1.5.3</span> 3. Curl Command Generator
(<code>generate_curl_commands.sh</code>)</h3>
<ul>
<li><strong>Best for:</strong> Manual testing and debugging</li>
<li><strong>Features:</strong> Generates ready-to-use curl commands</li>
<li><strong>Usage:</strong>
<code>./generate_curl_commands.sh [options]</code></li>
</ul>
<hr />
<h2 data-number="1.6" id="configuration-guide"><span
class="header-section-number">1.6</span> Configuration Guide</h2>
<h3 data-number="1.6.1" id="environment-variables"><span
class="header-section-number">1.6.1</span> Environment Variables</h3>
<p>Create a <code>.env</code> file in your project directory:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow Instance (without https://)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_INSTANCE</span><span class="op">=</span>your-company.service-now.com</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Agent ID (found in ServiceNow agent configuration)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_AGENT_ID</span><span class="op">=</span>your-agent-id-here</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># API Key (generated in ServiceNow)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_TOKEN</span><span class="op">=</span>your-api-key-here</span></code></pre></div>
<h3 data-number="1.6.2" id="finding-your-agent-id"><span
class="header-section-number">1.6.2</span> Finding Your Agent ID</h3>
<ol type="1">
<li>Log into your ServiceNow instance</li>
<li>Navigate to <strong>Agent Intelligence</strong> &gt;
<strong>Agents</strong></li>
<li>Select your agent</li>
<li>Copy the ID from the URL or agent details page</li>
</ol>
<h3 data-number="1.6.3" id="generating-an-api-key"><span
class="header-section-number">1.6.3</span> Generating an API Key</h3>
<ol type="1">
<li>In ServiceNow, go to <strong>System Web Services</strong> &gt;
<strong>REST API Explorer</strong></li>
<li>Or use the ServiceNow Developer Portal</li>
<li>Generate a new API key</li>
<li>Ensure it has permissions for A2A operations</li>
</ol>
<hr />
<h2 data-number="1.7" id="testing-methods"><span
class="header-section-number">1.7</span> Testing Methods</h2>
<h3 data-number="1.7.1" id="method-1-automated-testing-script"><span
class="header-section-number">1.7.1</span> Method 1: Automated Testing
Script</h3>
<p>The automated script provides the most comprehensive testing:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic test (uses .env configuration)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test with custom message</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">-m</span> <span class="st">&quot;What services do you provide?&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verbose output for debugging</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">-v</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Test only agent discovery</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">--discovery-only</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom configuration</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">-i</span> company.service-now.com <span class="at">-a</span> agent-id <span class="at">-t</span> api-key</span></code></pre></div>
<p><strong>Sample Output:</strong></p>
<pre><code>[INFO] ServiceNow A2A Agent Test
==================================
Instance: company.service-now.com
Agent ID: your-agent-id
API Key:  your-api-key...
Message:  What can you help me with?
==================================

[INFO] Step 1: Testing agent discovery...
[SUCCESS] Agent discovery successful!
  Agent Name: Your Agent Name
  Description: Agent description here

[INFO] Step 2: Sending test message to agent...
[SUCCESS] Message sent successfully!

[INFO] Agent Response:
Response 1: Hello! I can help you with...

[SUCCESS] All tests completed successfully!</code></pre>
<h3 data-number="1.7.2" id="method-2-python-client"><span
class="header-section-number">1.7.2</span> Method 2: Python Client</h3>
<p>Use the Python client for programmatic access:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> generic_a2a_client <span class="im">import</span> ServiceNowA2AClient</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> test_agent():</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Option 1: Use environment variables</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> ServiceNowA2AClient()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Option 2: Direct configuration</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># client = ServiceNowA2AClient(</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     instance=&quot;your-instance.service-now.com&quot;,</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     agent_id=&quot;your-agent-id&quot;,</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     api_key=&quot;your-api-key&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># )</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Send a simple message</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> <span class="cf">await</span> client.connect_and_send(<span class="st">&quot;What can you help me with?&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(response)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the test</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>asyncio.run(test_agent())</span></code></pre></div>
<p><strong>Advanced Usage with Context:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> conversation_test():</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> ServiceNowA2AClient()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First message</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    response1 <span class="op">=</span> <span class="cf">await</span> client.connect_and_send(<span class="st">&quot;What services do you provide?&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract context for follow-up</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    context_id <span class="op">=</span> response1.get(<span class="st">&#39;result&#39;</span>, {}).get(<span class="st">&#39;contextId&#39;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Follow-up message with context</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    response2 <span class="op">=</span> <span class="cf">await</span> client.connect_and_send(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Tell me more about the first one&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        context_id<span class="op">=</span>context_id</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response1, response2</span></code></pre></div>
<h3 data-number="1.7.3" id="method-3-manual-curl-commands"><span
class="header-section-number">1.7.3</span> Method 3: Manual Curl
Commands</h3>
<p>Generate and use curl commands for manual testing:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate commands</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./generate_curl_commands.sh</span> <span class="at">-m</span> <span class="st">&quot;Your test message&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use generated files</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ex">./discovery_command.sh</span> <span class="kw">|</span> <span class="ex">jq</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="ex">./send_message_command.sh</span> <span class="kw">|</span> <span class="ex">jq</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Or copy-paste the one-liner commands provided</span></span></code></pre></div>
<hr />
<h2 data-number="1.8" id="python-client-implementation"><span
class="header-section-number">1.8</span> Python Client
Implementation</h2>
<h3 data-number="1.8.1" id="complete-generic-client-code"><span
class="header-section-number">1.8.1</span> Complete Generic Client
Code</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">Generic ServiceNow A2A Client</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">A configurable client for connecting to any ServiceNow Agent-to-Agent (A2A) endpoint.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> uuid <span class="im">import</span> uuid4</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> httpx </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Optional, Dict, Any</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dataclasses <span class="im">import</span> dataclass</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Load environment variables from .env file if it exists</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>env_file <span class="op">=</span> Path(<span class="va">__file__</span>).parent <span class="op">/</span> <span class="st">&#39;.env&#39;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> env_file.exists():</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(env_file) <span class="im">as</span> f:</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> line.strip() <span class="kw">and</span> <span class="kw">not</span> line.startswith(<span class="st">&#39;#&#39;</span>):</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                key, value <span class="op">=</span> line.strip().split(<span class="st">&#39;=&#39;</span>, <span class="dv">1</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>                os.environ[key] <span class="op">=</span> value</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> a2a.client <span class="im">import</span> A2AClient</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> a2a.types <span class="im">import</span> (</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    AgentCard,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    SendMessageRequest,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    MessageSendParams,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclass</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ServiceNowConfig:</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Configuration for ServiceNow A2A client&quot;&quot;&quot;</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    instance: <span class="bu">str</span>  <span class="co"># e.g., &quot;your-instance.service-now.com&quot;</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    agent_id: <span class="bu">str</span>  <span class="co"># ServiceNow agent ID</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    api_key: <span class="bu">str</span>   <span class="co"># ServiceNow API key</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> base_url(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Base URL for A2A API&quot;&quot;&quot;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;https://</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>instance<span class="sc">}</span><span class="ss">/api/sn_aia/a2a/id&quot;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> discovery_url(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Agent discovery URL&quot;&quot;&quot;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>base_url<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>agent_id<span class="sc">}</span><span class="ss">/well_known/agent_json&quot;</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> from_env(cls) <span class="op">-&gt;</span> <span class="st">&#39;ServiceNowConfig&#39;</span>:</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Create configuration from environment variables&quot;&quot;&quot;</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        instance <span class="op">=</span> os.getenv(<span class="st">&quot;SERVICENOW_INSTANCE&quot;</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        agent_id <span class="op">=</span> os.getenv(<span class="st">&quot;SERVICENOW_AGENT_ID&quot;</span>) </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>        api_key <span class="op">=</span> os.getenv(<span class="st">&quot;SERVICENOW_TOKEN&quot;</span>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> instance:</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;SERVICENOW_INSTANCE environment variable is required&quot;</span>)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> agent_id:</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;SERVICENOW_AGENT_ID environment variable is required&quot;</span>)</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> api_key:</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;SERVICENOW_TOKEN environment variable is required&quot;</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cls(instance<span class="op">=</span>instance, agent_id<span class="op">=</span>agent_id, api_key<span class="op">=</span>api_key)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ServiceNowA2AClient:</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Generic ServiceNow A2A Client&quot;&quot;&quot;</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, instance: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>, agent_id: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>, api_key: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Initialize the ServiceNow A2A client&quot;&quot;&quot;</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> instance <span class="kw">and</span> agent_id <span class="kw">and</span> api_key:</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.config <span class="op">=</span> ServiceNowConfig(instance<span class="op">=</span>instance, agent_id<span class="op">=</span>agent_id, api_key<span class="op">=</span>api_key)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.config <span class="op">=</span> ServiceNowConfig.from_env()</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.agent_card: Optional[AgentCard] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.a2a_client: Optional[A2AClient] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> fetch_agent_card(<span class="va">self</span>, httpx_client: httpx.AsyncClient) <span class="op">-&gt;</span> AgentCard:</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Fetch agent card from ServiceNow discovery endpoint&quot;&quot;&quot;</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;🔍 Discovering agent at: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config<span class="sc">.</span>instance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>            headers <span class="op">=</span> {</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;content-type&#39;</span>: <span class="st">&#39;application/json&#39;</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;x-sn-apikey&#39;</span>: <span class="va">self</span>.config.api_key,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user-agent&#39;</span>: <span class="st">&#39;ServiceNow-A2A-Client/1.0&#39;</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="cf">await</span> httpx_client.get(<span class="va">self</span>.config.discovery_url, headers<span class="op">=</span>headers)</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>            agent_card_data <span class="op">=</span> response.json()</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>            agent_card <span class="op">=</span> AgentCard(<span class="op">**</span>agent_card_data)</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;✅ Agent discovered successfully!&quot;</span>)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;📝 Name: </span><span class="sc">{</span>agent_card<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.agent_card <span class="op">=</span> agent_card</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> agent_card</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error fetching agent card: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="ss">f&quot;Failed to fetch agent card: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> initialize_client(<span class="va">self</span>, httpx_client: httpx.AsyncClient) <span class="op">-&gt;</span> A2AClient:</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Initialize A2A client with the discovered agent card&quot;&quot;&quot;</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.agent_card:</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="st">&quot;Agent card not fetched. Call fetch_agent_card() first.&quot;</span>)</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>        client <span class="op">=</span> A2AClient(httpx_client<span class="op">=</span>httpx_client, agent_card<span class="op">=</span><span class="va">self</span>.agent_card)</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;✅ A2A Client initialized&quot;</span>)</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.a2a_client <span class="op">=</span> client</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> client</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> send_message(<span class="va">self</span>, message_text: <span class="bu">str</span>, context_id: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>, task_id: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Send a message to the ServiceNow agent&quot;&quot;&quot;</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.a2a_client:</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">RuntimeError</span>(<span class="st">&quot;A2A client not initialized. Call initialize_client() first.&quot;</span>)</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;💬 Sending message: </span><span class="sc">{</span>message_text<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>        request_id <span class="op">=</span> uuid4().<span class="bu">hex</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>        message_body <span class="op">=</span> {</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;message&#39;</span>: {</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;role&#39;</span>: <span class="st">&#39;user&#39;</span>,</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;parts&#39;</span>: [{<span class="st">&#39;kind&#39;</span>: <span class="st">&#39;text&#39;</span>, <span class="st">&#39;text&#39;</span>: message_text}],</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;messageId&#39;</span>: uuid4().<span class="bu">hex</span>,</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;kind&#39;</span>: <span class="st">&#39;message&#39;</span>  <span class="co"># SDK expects &#39;message&#39;</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;context&#39;</span>: {<span class="st">&#39;contextId&#39;</span>: context_id, <span class="st">&#39;taskId&#39;</span>: task_id},</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;metadata&#39;</span>: {},</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pushNotificationUrl&#39;</span>: <span class="ss">f&quot;http://localhost:8080/a2a/callback/</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>config<span class="sc">.</span>agent_id<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>request_id<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;id&#39;</span>: request_id</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>        request <span class="op">=</span> SendMessageRequest(<span class="bu">id</span><span class="op">=</span><span class="bu">str</span>(uuid4()), params<span class="op">=</span>MessageSendParams(<span class="op">**</span>message_body))</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.a2a_client.send_message(request)</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;✅ Message sent successfully!&quot;</span>)</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> response.model_dump(mode<span class="op">=</span><span class="st">&#39;json&#39;</span>, exclude_none<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;❌ Error sending message: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> connect_and_send(<span class="va">self</span>, message_text: <span class="bu">str</span>, context_id: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>, task_id: <span class="bu">str</span> <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Any]:</span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Convenience method to connect to agent and send a message in one call&quot;&quot;&quot;</span></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>        timeout <span class="op">=</span> httpx.Timeout(<span class="fl">30.0</span>, <span class="ex">connect</span><span class="op">=</span><span class="fl">10.0</span>)</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">async</span> <span class="cf">with</span> httpx.AsyncClient(timeout<span class="op">=</span>timeout) <span class="im">as</span> httpx_client:</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> <span class="va">self</span>.fetch_agent_card(httpx_client)</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.initialize_client(httpx_client)</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="cf">await</span> <span class="va">self</span>.send_message(message_text, context_id, task_id)</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> main():</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Example usage of the generic ServiceNow A2A client&quot;&quot;&quot;</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Generic ServiceNow A2A Client ===&quot;</span>)</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>        client <span class="op">=</span> ServiceNowA2AClient()</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;🏢 Instance: </span><span class="sc">{</span>client<span class="sc">.</span>config<span class="sc">.</span>instance<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;🤖 Agent ID: </span><span class="sc">{</span>client<span class="sc">.</span>config<span class="sc">.</span>agent_id<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Send a message to the agent</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>        message <span class="op">=</span> <span class="st">&quot;What can you help me with?&quot;</span></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> <span class="cf">await</span> client.connect_and_send(message)</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">✅ A2A Client completed successfully!&quot;</span>)</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span> <span class="im">as</span> e:</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;❌ Configuration Error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Required environment variables:&quot;</span>)</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  SERVICENOW_INSTANCE=your-instance.service-now.com&quot;</span>)</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  SERVICENOW_AGENT_ID=your-agent-id&quot;</span>)</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;  SERVICENOW_TOKEN=your-api-key&quot;</span>)</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;❌ A2A Client failed: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>    asyncio.run(main())</span></code></pre></div>
<hr />
<h2 data-number="1.9" id="curl-testing-scripts"><span
class="header-section-number">1.9</span> Curl Testing Scripts</h2>
<h3 data-number="1.9.1" id="automated-testing-script"><span
class="header-section-number">1.9.1</span> Automated Testing Script</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow A2A Agent Test Script</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This script generates and executes curl commands to test any ServiceNow agent</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Color codes for output</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="va">RED</span><span class="op">=</span><span class="st">&#39;\033[0;31m&#39;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="va">GREEN</span><span class="op">=</span><span class="st">&#39;\033[0;32m&#39;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="va">YELLOW</span><span class="op">=</span><span class="st">&#39;\033[1;33m&#39;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="va">BLUE</span><span class="op">=</span><span class="st">&#39;\033[0;34m&#39;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="va">NC</span><span class="op">=</span><span class="st">&#39;\033[0m&#39;</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print_status()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${BLUE}</span><span class="st">[INFO]</span><span class="va">${NC}</span><span class="st"> </span><span class="va">$1</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print_success()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${GREEN}</span><span class="st">[SUCCESS]</span><span class="va">${NC}</span><span class="st"> </span><span class="va">$1</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print_error()</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="at">-e</span> <span class="st">&quot;</span><span class="va">${RED}</span><span class="st">[ERROR]</span><span class="va">${NC}</span><span class="st"> </span><span class="va">$1</span><span class="st">&quot;</span><span class="kw">;</span> <span class="kw">}</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load configuration from .env file if it exists</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-f</span> .env <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_status</span> <span class="st">&quot;Loading configuration from .env file...&quot;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">export</span> <span class="va">$(</span><span class="fu">grep</span> <span class="at">-v</span> <span class="st">&#39;^#&#39;</span> .env <span class="kw">|</span> <span class="fu">xargs</span><span class="va">)</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration variables</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_INSTANCE</span><span class="op">=</span><span class="va">${SERVICENOW_INSTANCE</span><span class="op">:-</span><span class="st">&quot;&quot;</span><span class="va">}</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_AGENT_ID</span><span class="op">=</span><span class="va">${SERVICENOW_AGENT_ID</span><span class="op">:-</span><span class="st">&quot;&quot;</span><span class="va">}</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_TOKEN</span><span class="op">=</span><span class="va">${SERVICENOW_TOKEN</span><span class="op">:-</span><span class="st">&quot;&quot;</span><span class="va">}</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse command line arguments</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="va">CUSTOM_MESSAGE</span><span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="va">DISCOVERY_ONLY</span><span class="op">=</span>false</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="va">VERBOSE</span><span class="op">=</span>false</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">[[</span> <span class="va">$#</span> <span class="ot">-gt</span> 0 <span class="kw">]];</span> <span class="cf">do</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="va">$1</span> <span class="kw">in</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-i</span><span class="kw">|</span><span class="ss">--instance</span><span class="kw">)</span> <span class="va">SERVICENOW_INSTANCE</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$2</span><span class="st">&quot;</span><span class="kw">;</span> <span class="bu">shift</span> 2 <span class="cf">;;</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-a</span><span class="kw">|</span><span class="ss">--agent-id</span><span class="kw">)</span> <span class="va">SERVICENOW_AGENT_ID</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$2</span><span class="st">&quot;</span><span class="kw">;</span> <span class="bu">shift</span> 2 <span class="cf">;;</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-t</span><span class="kw">|</span><span class="ss">--token</span><span class="kw">)</span> <span class="va">SERVICENOW_TOKEN</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$2</span><span class="st">&quot;</span><span class="kw">;</span> <span class="bu">shift</span> 2 <span class="cf">;;</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-m</span><span class="kw">|</span><span class="ss">--message</span><span class="kw">)</span> <span class="va">CUSTOM_MESSAGE</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$2</span><span class="st">&quot;</span><span class="kw">;</span> <span class="bu">shift</span> 2 <span class="cf">;;</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-d</span><span class="kw">|</span><span class="ss">--discovery-only</span><span class="kw">)</span> <span class="va">DISCOVERY_ONLY</span><span class="op">=</span>true<span class="kw">;</span> <span class="bu">shift</span> <span class="cf">;;</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-v</span><span class="kw">|</span><span class="ss">--verbose</span><span class="kw">)</span> <span class="va">VERBOSE</span><span class="op">=</span>true<span class="kw">;</span> <span class="bu">shift</span> <span class="cf">;;</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        <span class="ss">-h</span><span class="kw">|</span><span class="ss">--help</span><span class="kw">)</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;Usage: </span><span class="va">$0</span><span class="st"> [OPTIONS]&quot;</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;Test a ServiceNow A2A agent using curl commands&quot;</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;&quot;</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;Options:&quot;</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -i, --instance INSTANCE    ServiceNow instance&quot;</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -a, --agent-id AGENT_ID    Agent ID&quot;</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -t, --token TOKEN          API token&quot;</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -m, --message MESSAGE      Custom message&quot;</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -d, --discovery-only       Only test discovery&quot;</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -v, --verbose              Verbose output&quot;</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>            <span class="bu">echo</span> <span class="st">&quot;  -h, --help                 Show this help&quot;</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exit</span> 0 <span class="cf">;;</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>        <span class="pp">*</span><span class="kw">)</span> <span class="ex">print_error</span> <span class="st">&quot;Unknown option: </span><span class="va">$1</span><span class="st">&quot;</span><span class="kw">;</span> <span class="bu">exit</span> 1 <span class="cf">;;</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">esac</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate required configuration</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$SERVICENOW_INSTANCE</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$SERVICENOW_AGENT_ID</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$SERVICENOW_TOKEN</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_error</span> <span class="st">&quot;Missing required configuration&quot;</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Required: SERVICENOW_INSTANCE, SERVICENOW_AGENT_ID, SERVICENOW_TOKEN&quot;</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default message</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$CUSTOM_MESSAGE</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="va">CUSTOM_MESSAGE</span><span class="op">=</span><span class="st">&quot;Hello! This is a test message. What can you help me with?&quot;</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Build URLs</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a><span class="va">BASE_URL</span><span class="op">=</span><span class="st">&quot;https://</span><span class="va">${SERVICENOW_INSTANCE}</span><span class="st">/api/sn_aia/a2a/id&quot;</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="va">DISCOVERY_URL</span><span class="op">=</span><span class="st">&quot;</span><span class="va">${BASE_URL}</span><span class="st">/</span><span class="va">${SERVICENOW_AGENT_ID}</span><span class="st">/well_known/agent_json&quot;</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="va">INVOCATION_URL</span><span class="op">=</span><span class="st">&quot;https://</span><span class="va">${SERVICENOW_INSTANCE}</span><span class="st">/api/sn_aia/a2a/v1/agent/id/</span><span class="va">${SERVICENOW_AGENT_ID}</span><span class="st">&quot;</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a><span class="ex">print_status</span> <span class="st">&quot;ServiceNow A2A Agent Test&quot;</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;==================================&quot;</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Instance: </span><span class="va">$SERVICENOW_INSTANCE</span><span class="st">&quot;</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Agent ID: </span><span class="va">$SERVICENOW_AGENT_ID</span><span class="st">&quot;</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Message:  </span><span class="va">$CUSTOM_MESSAGE</span><span class="st">&quot;</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;==================================&quot;</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 1: Agent Discovery</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="ex">print_status</span> <span class="st">&quot;Step 1: Testing agent discovery...&quot;</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="va">DISCOVERY_RESPONSE</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-w</span> <span class="st">&quot;\n%{http_code}&quot;</span> <span class="dt">\</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;x-sn-apikey: </span><span class="va">$SERVICENOW_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;User-Agent: ServiceNow-A2A-Test/1.0&quot;</span> <span class="dt">\</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">$DISCOVERY_URL</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="va">HTTP_STATUS</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_RESPONSE</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="va">DISCOVERY_BODY</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_RESPONSE</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;$d&#39;</span><span class="va">)</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$HTTP_STATUS</span><span class="st">&quot;</span> <span class="ot">=</span> <span class="st">&quot;200&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_success</span> <span class="st">&quot;Agent discovery successful!&quot;</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>    <span class="va">AGENT_NAME</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_BODY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-c</span> <span class="st">&quot;import sys, json; data=json.load(sys.stdin); print(data.get(&#39;name&#39;, &#39;Unknown&#39;))&quot;</span> <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="bu">echo</span> <span class="st">&quot;Unknown&quot;</span><span class="va">)</span></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;  Agent Name: </span><span class="va">$AGENT_NAME</span><span class="st">&quot;</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$VERBOSE</span><span class="st">&quot;</span> <span class="ot">=</span> true <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;&quot;</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>        <span class="ex">print_status</span> <span class="st">&quot;Full agent card response:&quot;</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_BODY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-m</span> json.tool <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_BODY</span><span class="st">&quot;</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_error</span> <span class="st">&quot;Agent discovery failed! HTTP Status: </span><span class="va">$HTTP_STATUS</span><span class="st">&quot;</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Response: </span><span class="va">$DISCOVERY_BODY</span><span class="st">&quot;</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Exit if discovery-only mode</span></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$DISCOVERY_ONLY</span><span class="st">&quot;</span> <span class="ot">=</span> true <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_success</span> <span class="st">&quot;Discovery-only mode completed successfully!&quot;</span></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 0</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 2: Send Message</span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a><span class="ex">print_status</span> <span class="st">&quot;Step 2: Sending test message to agent...&quot;</span></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="va">REQUEST_ID</span><span class="op">=</span><span class="va">$(</span><span class="fu">uuidgen</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39;[:upper:]&#39;</span> <span class="st">&#39;[:lower:]&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="at">-d</span> <span class="st">&#39;-&#39;</span><span class="va">)</span></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="va">MESSAGE_ID</span><span class="op">=</span><span class="va">$(</span><span class="fu">uuidgen</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="st">&#39;[:upper:]&#39;</span> <span class="st">&#39;[:lower:]&#39;</span> <span class="kw">|</span> <span class="fu">tr</span> <span class="at">-d</span> <span class="st">&#39;-&#39;</span><span class="va">)</span></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a><span class="va">JSON_PAYLOAD</span><span class="op">=</span><span class="va">$(</span><span class="fu">cat</span> <span class="op">&lt;&lt;EOF</span></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;method&quot;: &quot;message/send&quot;,</span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;params&quot;: {</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;message&quot;: {</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;role&quot;: &quot;user&quot;,</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;parts&quot;: [{&quot;kind&quot;: &quot;text&quot;, &quot;text&quot;: &quot;</span><span class="va">$CUSTOM_MESSAGE</span><span class="st">&quot;}],</span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;messageId&quot;: &quot;</span><span class="va">$MESSAGE_ID</span><span class="st">&quot;,</span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a><span class="st">      &quot;kind&quot;: &quot;user&quot;</span></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a><span class="st">    },</span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;context&quot;: {&quot;contextId&quot;: null, &quot;taskId&quot;: null},</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;metadata&quot;: {},</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;pushNotificationUrl&quot;: &quot;http://localhost:8080/a2a/callback/test/</span><span class="va">$REQUEST_ID</span><span class="st">&quot;,</span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;id&quot;: &quot;</span><span class="va">$REQUEST_ID</span><span class="st">&quot;</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a><span class="st">  },</span></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;id&quot;: &quot;</span><span class="va">$REQUEST_ID</span><span class="st">&quot;</span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a><span class="va">)</span></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a><span class="va">MESSAGE_RESPONSE</span><span class="op">=</span><span class="va">$(</span><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-w</span> <span class="st">&quot;\n%{http_code}&quot;</span> <span class="dt">\</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">-X</span> POST <span class="dt">\</span></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;Content-Type: application/json&quot;</span> <span class="dt">\</span></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;x-sn-apikey: </span><span class="va">$SERVICENOW_TOKEN</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">-H</span> <span class="st">&quot;User-Agent: ServiceNow-A2A-Test/1.0&quot;</span> <span class="dt">\</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">-d</span> <span class="st">&quot;</span><span class="va">$JSON_PAYLOAD</span><span class="st">&quot;</span> <span class="dt">\</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;</span><span class="va">$INVOCATION_URL</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a><span class="va">HTTP_STATUS</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$MESSAGE_RESPONSE</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">tail</span> <span class="at">-n</span> 1<span class="va">)</span></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a><span class="va">MESSAGE_BODY</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$MESSAGE_RESPONSE</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;$d&#39;</span><span class="va">)</span></span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$HTTP_STATUS</span><span class="st">&quot;</span> <span class="ot">=</span> <span class="st">&quot;200&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_success</span> <span class="st">&quot;Message sent successfully!&quot;</span></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract agent response</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>    <span class="va">AGENT_RESPONSES</span><span class="op">=</span><span class="va">$(</span><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$MESSAGE_BODY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-c</span> <span class="st">&quot;</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a><span class="st">import sys, json</span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a><span class="st">try:</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a><span class="st">    data = json.load(sys.stdin)</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a><span class="st">    result = data.get(&#39;result&#39;, {})</span></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="st">    status = result.get(&#39;status&#39;, {})</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a><span class="st">    message = status.get(&#39;message&#39;, {})</span></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a><span class="st">    parts = message.get(&#39;parts&#39;, [])</span></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a><span class="st">    for i, part in enumerate(parts):</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a><span class="st">        if part.get(&#39;kind&#39;) == &#39;text&#39;:</span></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a><span class="st">            print(f&#39;Response {i+1}: {part.get(</span><span class="dt">\&quot;</span><span class="st">text</span><span class="dt">\&quot;</span><span class="st">, </span><span class="dt">\&quot;\&quot;</span><span class="st">)}&#39;)</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a><span class="st">except:</span></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a><span class="st">    print(&#39;Could not parse agent response&#39;)</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span> <span class="dv">2</span><span class="op">&gt;</span>/dev/null<span class="va">)</span></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="ot">-n</span> <span class="st">&quot;</span><span class="va">$AGENT_RESPONSES</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>        <span class="ex">print_status</span> <span class="st">&quot;Agent Response:&quot;</span></span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$AGENT_RESPONSES</span><span class="st">&quot;</span></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">[</span> <span class="st">&quot;</span><span class="va">$VERBOSE</span><span class="st">&quot;</span> <span class="ot">=</span> true <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;&quot;</span></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>        <span class="ex">print_status</span> <span class="st">&quot;Full response:&quot;</span></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>        <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$MESSAGE_BODY</span><span class="st">&quot;</span> <span class="kw">|</span> <span class="ex">python3</span> <span class="at">-m</span> json.tool <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="bu">echo</span> <span class="st">&quot;</span><span class="va">$MESSAGE_BODY</span><span class="st">&quot;</span></span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">fi</span></span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>    <span class="ex">print_error</span> <span class="st">&quot;Message sending failed! HTTP Status: </span><span class="va">$HTTP_STATUS</span><span class="st">&quot;</span></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&quot;Response: </span><span class="va">$MESSAGE_BODY</span><span class="st">&quot;</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a><span class="ex">print_success</span> <span class="st">&quot;All tests completed successfully!&quot;</span></span></code></pre></div>
<hr />
<h2 data-number="1.10" id="troubleshooting"><span
class="header-section-number">1.10</span> Troubleshooting</h2>
<h3 data-number="1.10.1" id="common-issues-and-solutions"><span
class="header-section-number">1.10.1</span> Common Issues and
Solutions</h3>
<h4 data-number="1.10.1.1"
id="authentication-errors-401-unauthorized"><span
class="header-section-number">1.10.1.1</span> 1. Authentication Errors
(401 Unauthorized)</h4>
<p><strong>Problem:</strong> API key authentication fails</p>
<p><strong>Solutions:</strong> - Verify your API key is correct and not
expired - Ensure the API key has A2A permissions - Check that you’re
using the correct ServiceNow instance URL - Try regenerating the API key
in ServiceNow</p>
<h4 data-number="1.10.1.2" id="agent-not-found-404-not-found"><span
class="header-section-number">1.10.1.2</span> 2. Agent Not Found (404
Not Found)</h4>
<p><strong>Problem:</strong> Agent discovery fails</p>
<p><strong>Solutions:</strong> - Verify the agent ID is correct - Ensure
the agent is published and active - Check the discovery URL format:
<code>{instance}/api/sn_aia/a2a/id/{agent_id}/well_known/agent_json</code></p>
<h4 data-number="1.10.1.3" id="connection-timeouts"><span
class="header-section-number">1.10.1.3</span> 3. Connection
Timeouts</h4>
<p><strong>Problem:</strong> Requests timeout or fail to connect</p>
<p><strong>Solutions:</strong> - Check network connectivity to your
ServiceNow instance - Verify the instance URL is accessible - Try
increasing timeout values in the scripts - Check for firewall or proxy
issues</p>
<h4 data-number="1.10.1.4" id="invalid-json-response"><span
class="header-section-number">1.10.1.4</span> 4. Invalid JSON
Response</h4>
<p><strong>Problem:</strong> Malformed JSON in responses</p>
<p><strong>Solutions:</strong> - Check if the agent is properly
configured - Verify the agent supports the A2A protocol - Try the
discovery endpoint first to validate connectivity</p>
<h4 data-number="1.10.1.5" id="python-import-errors"><span
class="header-section-number">1.10.1.5</span> 5. Python Import
Errors</h4>
<p><strong>Problem:</strong> Missing Python dependencies</p>
<p><strong>Solutions:</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install required packages</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install httpx a2a-sdk</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or create a virtual environment</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> venv venv</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> venv/bin/activate  <span class="co"># On Windows: venv\Scripts\activate</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install httpx a2a-sdk</span></code></pre></div>
<h3 data-number="1.10.2" id="debugging-tips"><span
class="header-section-number">1.10.2</span> Debugging Tips</h3>
<ol type="1">
<li><p><strong>Use Verbose Mode:</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">-v</span></span></code></pre></div></li>
<li><p><strong>Test Discovery Only:</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./test_servicenow_agent.sh</span> <span class="at">--discovery-only</span></span></code></pre></div></li>
<li><p><strong>Check Raw Responses:</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> <span class="at">-H</span> <span class="st">&quot;x-sn-apikey: your-key&quot;</span> <span class="st">&quot;your-discovery-url&quot;</span></span></code></pre></div></li>
<li><p><strong>Validate JSON:</strong></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./discovery_command.sh</span> <span class="kw">|</span> <span class="ex">jq</span></span></code></pre></div></li>
</ol>
<hr />
<h2 data-number="1.11" id="appendix"><span
class="header-section-number">1.11</span> Appendix</h2>
<h3 data-number="1.11.1" id="a.-servicenow-a2a-protocol-details"><span
class="header-section-number">1.11.1</span> A. ServiceNow A2A Protocol
Details</h3>
<h4 data-number="1.11.1.1" id="discovery-url-pattern"><span
class="header-section-number">1.11.1.1</span> Discovery URL Pattern</h4>
<pre><code>https://{instance}/api/sn_aia/a2a/id/{agent_id}/well_known/agent_json</code></pre>
<h4 data-number="1.11.1.2" id="invocation-url-pattern"><span
class="header-section-number">1.11.1.2</span> Invocation URL
Pattern</h4>
<pre><code>https://{instance}/api/sn_aia/a2a/v1/agent/id/{agent_id}</code></pre>
<h4 data-number="1.11.1.3" id="required-headers"><span
class="header-section-number">1.11.1.3</span> Required Headers</h4>
<pre><code>Content-Type: application/json
x-sn-apikey: your-api-key
User-Agent: your-client-name</code></pre>
<h4 data-number="1.11.1.4" id="message-format"><span
class="header-section-number">1.11.1.4</span> Message Format</h4>
<div class="sourceCode" id="cb21"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;jsonrpc&quot;</span><span class="fu">:</span> <span class="st">&quot;2.0&quot;</span><span class="fu">,</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="st">&quot;message/send&quot;</span><span class="fu">,</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;params&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;role&quot;</span><span class="fu">:</span> <span class="st">&quot;user&quot;</span><span class="fu">,</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;parts&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;kind&quot;</span><span class="fu">:</span> <span class="st">&quot;text&quot;</span><span class="fu">,</span> <span class="dt">&quot;text&quot;</span><span class="fu">:</span> <span class="st">&quot;your message&quot;</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;messageId&quot;</span><span class="fu">:</span> <span class="st">&quot;unique-message-id&quot;</span><span class="fu">,</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;kind&quot;</span><span class="fu">:</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;context&quot;</span><span class="fu">:</span> <span class="fu">{</span><span class="dt">&quot;contextId&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span> <span class="dt">&quot;taskId&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">},</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;metadata&quot;</span><span class="fu">:</span> <span class="fu">{},</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pushNotificationUrl&quot;</span><span class="fu">:</span> <span class="st">&quot;your-callback-url&quot;</span><span class="fu">,</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;unique-request-id&quot;</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;unique-request-id&quot;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 data-number="1.11.2" id="b.-file-structure"><span
class="header-section-number">1.11.2</span> B. File Structure</h3>
<pre><code>servicenow-a2a-testing/
├── .env                           # Configuration file
├── .env.template                  # Configuration template
├── generic_a2a_client.py         # Python A2A client
├── test_servicenow_agent.sh      # Automated testing script
├── generate_curl_commands.sh     # Curl command generator
├── examples.py                    # Python usage examples
├── README.md                      # Documentation
└── requirements.txt               # Python dependencies</code></pre>
<h3 data-number="1.11.3" id="c.-environment-template"><span
class="header-section-number">1.11.3</span> C. Environment Template</h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow A2A Client Configuration</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy this file to .env and fill in your values</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow Instance (without https://)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_INSTANCE</span><span class="op">=</span>your-instance.service-now.com</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow Agent ID</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_AGENT_ID</span><span class="op">=</span>your-agent-id-here</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ServiceNow API Key</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="va">SERVICENOW_TOKEN</span><span class="op">=</span>your-api-key-here</span></code></pre></div>
<h3 data-number="1.11.4" id="d.-requirements-file"><span
class="header-section-number">1.11.4</span> D. Requirements File</h3>
<pre><code>httpx&gt;=0.24.0
a2a-sdk&gt;=1.0.0</code></pre>
<hr />
<h2 data-number="1.12" id="support-and-resources"><span
class="header-section-number">1.12</span> Support and Resources</h2>
<h3 data-number="1.12.1" id="servicenow-documentation"><span
class="header-section-number">1.12.1</span> ServiceNow
Documentation</h3>
<ul>
<li><a href="https://docs.servicenow.com/">ServiceNow A2A
Documentation</a></li>
<li><a
href="https://docs.servicenow.com/bundle/vancouver-ai-intelligence/page/administer/agent-intelligence/concept/agent-intelligence-landing-page.html">Agent
Intelligence Platform</a></li>
</ul>
<h3 data-number="1.12.2" id="community-resources"><span
class="header-section-number">1.12.2</span> Community Resources</h3>
<ul>
<li>ServiceNow Community Forums</li>
<li>ServiceNow Developer Portal</li>
<li>A2A SDK Documentation</li>
</ul>
<h3 data-number="1.12.3" id="contact-information"><span
class="header-section-number">1.12.3</span> Contact Information</h3>
<p>For technical support with these testing tools, please refer to your
ServiceNow administrator or the ServiceNow community resources.</p>
<hr />
<p><strong>Document Version:</strong> 1.0<br />
<strong>Last Updated:</strong> September 2025<br />
<strong>© ServiceNow A2A Testing Guide</strong></p>
</body>
</html>
